import{a as m}from"/build/_shared/chunk-N5UUCJCY.js";import{a as b,e as S,h as w,q as l}from"/build/_shared/chunk-CR5QNRSR.js";import{c as t}from"/build/_shared/chunk-Q3IECNXJ.js";var s=t(b(),1);var v=t(b(),1);function C(e,i){let[r,c]=(0,v.useState)(e);return(0,v.useEffect)(()=>{let d=setTimeout(()=>{c(e)},i);return()=>{clearTimeout(d)}},[e,i]),r}var a=t(l(),1);function I(){let[e,i]=(0,s.useState)(""),[r,c]=(0,s.useState)([]),[d,g]=(0,s.useState)(!1),[T,L]=(0,s.useState)(1),[E,M]=(0,s.useState)(!0),p=C(e,300),$=S(),k=(0,s.useRef)(null),R=async()=>{if(!(!p||!E||d)){g(!0);try{let h=await(await fetch(`/api/search?q=${encodeURIComponent(p)}&page=${T}&limit=10`)).json();c(N=>[...N,...h.posts]),M(h.hasMore),L(N=>N+1)}catch(o){console.error("Search error:",o)}finally{g(!1)}}};return(0,s.useEffect)(()=>{p&&(c([]),L(1),M(!0),R())},[p]),(0,s.useEffect)(()=>{let o=new IntersectionObserver(h=>{h[0].isIntersecting&&R()},{threshold:.5});return k.current&&o.observe(k.current),()=>o.disconnect()},[E,p,T]),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"search",placeholder:"\u641C\u7D22\u6587\u7AE0...",value:e,onChange:o=>i(o.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-200 dark:border-gray-700 focus:ring-2 focus:ring-primary"}),(r.length>0||d)&&(0,a.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-2 max-h-[60vh] overflow-auto bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:[r.map(o=>(0,a.jsxs)("button",{onClick:()=>{$(`/blog/${o.slug}`),i(""),c([])},className:"block w-full px-4 py-2 text-left hover:bg-gray-100 dark:hover:bg-gray-700",children:[(0,a.jsx)("div",{className:"font-medium",children:o.title}),(0,a.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:o.excerpt})]},o.slug)),d&&(0,a.jsx)("div",{className:"p-4 text-center text-gray-500",children:(0,a.jsx)("div",{className:"animate-pulse",children:"\u52A0\u8F7D\u4E2D..."})}),(0,a.jsx)("div",{ref:k})]})]})}var x=t(b(),1);var y=t(b(),1);function D(){let[e,i]=(0,y.useState)(()=>{if(typeof window<"u"){let r=localStorage.getItem("theme");if(r)return r;if(window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark"}return"light"});return(0,y.useEffect)(()=>{let r=window.document.documentElement;r.classList.add("transition-colors","duration-200"),r.classList.remove("light","dark"),r.classList.add(e),localStorage.setItem("theme",e);let c=window.matchMedia("(prefers-color-scheme: dark)"),d=g=>{i(g.matches?"dark":"light")};return c.addEventListener("change",d),()=>c.removeEventListener("change",d)},[e]),{theme:e,setTheme:i}}var P=t(l(),1);function H(){let{theme:e,setTheme:i}=D(),[r,c]=(0,x.useState)(!1);return(0,x.useEffect)(()=>{c(!0)},[]),r?(0,P.jsx)("button",{onClick:()=>i(e==="dark"?"light":"dark"),className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-800","aria-label":"\u5207\u6362\u4E3B\u9898",children:e==="dark"?"\u{1F31E}":"\u{1F319}"}):null}var n=t(l(),1);function Q(){return(0,n.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,n.jsxs)("div",{className:"container mx-auto flex h-16 items-center justify-between px-4",children:[(0,n.jsx)(w,{to:"/",className:"flex items-center space-x-2",children:(0,n.jsx)("span",{className:"text-xl font-bold",children:m.site.name})}),(0,n.jsx)("nav",{className:"flex items-center space-x-6",children:m.nav.map(e=>(0,n.jsx)(w,{to:e.href,className:"text-sm font-medium transition-colors hover:text-primary",children:e.title},e.href))}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)(I,{}),(0,n.jsx)(H,{})]})]})})}var u=t(l(),1);function F(){return(0,u.jsx)("footer",{className:"border-t py-6 md:py-0",children:(0,u.jsxs)("div",{className:"container mx-auto flex flex-col items-center justify-between gap-4 px-4 md:h-16 md:flex-row",children:[(0,u.jsxs)("p",{className:"text-sm text-gray-500",children:["\xA9 ",new Date().getFullYear()," ",m.site.name,". All rights reserved."]}),(0,u.jsxs)("div",{className:"flex items-center space-x-4",children:[m.social.github&&(0,u.jsx)("a",{href:m.social.github,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-primary",children:"GitHub"}),m.social.twitter&&(0,u.jsx)("a",{href:m.social.twitter,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-primary",children:"Twitter"})]})]})})}var f=t(l(),1);function ee({children:e}){return(0,f.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,f.jsx)(Q,{}),(0,f.jsx)("main",{className:"flex-1 container mx-auto px-4 py-8",children:e}),(0,f.jsx)(F,{})]})}export{ee as a};
