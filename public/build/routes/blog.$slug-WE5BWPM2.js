import{a as O,b as A}from"/build/_shared/chunk-LMTMRXRA.js";import{a as g}from"/build/_shared/chunk-IREONBNR.js";import{a as y}from"/build/_shared/chunk-N5UUCJCY.js";import{a as b,c as N,f as w,h as L,m as k,q as l}from"/build/_shared/chunk-CR5QNRSR.js";import{c as o}from"/build/_shared/chunk-Q3IECNXJ.js";var H=o(O(),1);var M=o(A(),1);var h=o(l(),1);function R({tags:e}){return(0,h.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(n=>(0,h.jsx)(L,{to:`/tags/${n}`,className:"text-sm px-3 py-1 bg-gray-100 dark:bg-gray-800 rounded-full hover:bg-primary hover:text-white transition-colors",children:n},n))})}var a=o(b(),1),m=o(l(),1);function T(){let[e,n]=(0,a.useState)([]),[d,x]=(0,a.useState)(""),u=(0,a.useMemo)(()=>e.reduce((r,s)=>{if(!s.text.trim())return r;let i=s.id||s.text.toLowerCase().replace(/\s+/g,"-");return[...r,{...s,id:i}]},[]),[e]),p=(0,a.useCallback)(r=>{let s=r.filter(i=>i.isIntersecting).sort((i,c)=>{let I=Math.abs(i.boundingClientRect.top),P=Math.abs(c.boundingClientRect.top);return I-P});s.length>0&&x(s[0].target.id)},[]);return(0,a.useEffect)(()=>{try{let r=Array.from(document.querySelectorAll("h2, h3, h4")),s=r.map(c=>({id:c.id,text:c.textContent||"",level:Number(c.tagName.charAt(1))}));n(s);let i=new IntersectionObserver(p,{rootMargin:"0% 0% -80% 0%",threshold:[0,.5,1]});return r.forEach(c=>i.observe(c)),()=>i.disconnect()}catch(r){console.error("Error setting up TableOfContents:",r),n([])}},[p]),u.length===0?null:(0,m.jsxs)("nav",{className:"sticky top-24 max-h-[calc(100vh-6rem)] overflow-auto","aria-label":"\u6587\u7AE0\u76EE\u5F55",children:[(0,m.jsx)("h2",{className:"font-bold mb-4",children:"\u76EE\u5F55"}),(0,m.jsx)("ul",{className:"space-y-2",children:u.map(r=>(0,m.jsx)("li",{style:{paddingLeft:`${(r.level-2)*1}rem`},children:(0,m.jsx)("a",{href:`#${r.id}`,className:`block text-sm hover:text-primary transition-colors ${d===r.id?"text-primary font-medium":"text-gray-600 dark:text-gray-400"}`,"aria-current":d===r.id?"true":void 0,children:r.text})},r.id))})]})}var f=o(b(),1),v=o(l(),1);function C(){let[e,n]=(0,f.useState)(0);return(0,f.useEffect)(()=>{let d=()=>{let{scrollTop:x,scrollHeight:u,clientHeight:p}=document.documentElement,r=u-p,s=x/r*100;n(s)};return window.addEventListener("scroll",d),()=>window.removeEventListener("scroll",d)},[]),(0,v.jsx)("div",{className:"fixed top-0 left-0 w-full h-1 bg-gray-200 dark:bg-gray-800 z-50",children:(0,v.jsx)("div",{className:"h-full bg-primary transition-all duration-200",style:{width:`${e}%`}})})}var t=o(l(),1),$=({data:e})=>e?.post?[{title:`${e.post.title} - ${y.site.name}`},{name:"description",content:e.post.excerpt}]:[{title:"\u6587\u7AE0\u672A\u627E\u5230 - "+y.site.name},{name:"description",content:"\u62B1\u6B49\uFF0C\u60A8\u8BF7\u6C42\u7684\u6587\u7AE0\u4E0D\u5B58\u5728\u3002"}];function S(){let e=w();return N(e)?(0,t.jsx)(g,{children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-4",children:e.status===404?"\u6587\u7AE0\u672A\u627E\u5230":"\u51FA\u9519\u4E86"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:e.data})]})}):(0,t.jsx)(g,{children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"\u670D\u52A1\u5668\u9519\u8BEF"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"\u62B1\u6B49\uFF0C\u670D\u52A1\u5668\u51FA\u73B0\u4E86\u95EE\u9898\u3002\u8BF7\u7A0D\u540E\u518D\u8BD5\u3002"})]})})}function E(){let{post:e}=k();return(0,t.jsxs)(g,{children:[(0,t.jsx)(C,{}),(0,t.jsxs)("article",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("header",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold mb-4",children:e.title}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-gray-600 dark:text-gray-400",children:[e.author&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("img",{src:e.author.avatar||"/images/default-avatar.png",alt:e.author.name,className:"w-8 h-8 rounded-full"}),(0,t.jsx)("span",{children:e.author.name})]}),(0,t.jsx)("time",{dateTime:e.date,children:new Date(e.date).toLocaleDateString("zh-CN")}),(0,t.jsxs)("span",{children:[e.readingTime," \u5206\u949F\u9605\u8BFB"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_250px] gap-8",children:[(0,t.jsx)("div",{className:"prose prose-lg dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:e.content}}),(0,t.jsx)("aside",{className:"hidden lg:block",children:(0,t.jsx)(T,{})})]}),(0,t.jsx)("footer",{className:"mt-8 pt-8 border-t dark:border-gray-800",children:(0,t.jsx)(R,{tags:e.tags})})]})]})}export{S as ErrorBoundary,E as default,$ as meta};
